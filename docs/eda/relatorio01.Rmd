---
title: "R Notebook"
output: html_notebook
---

```{r warning=FALSE, message=FALSE, error=FALSE}
library(tidyverse)
library(readr)
library(tm)
```


# Análises descritiva de dados

## Análise das reclamações

```{r warning=FALSE, message=FALSE, error=FALSE}
links_listas_orgaos <- read_csv("../../data/reclamacoes-raw/links-listas-orgaos.csv")
reclamacoes_raw <- read_csv("../../data/reclamacoes-raw/reclamacoes-raw.csv")
```

Olhando rapidamente a estrutura dos dados

```{r warning=FALSE, message=FALSE, error=FALSE}
glimpse(reclamacoes_raw)
```

Calculando tamanho de reclamações e de títulos

```{r warning=FALSE, message=FALSE, error=FALSE}
reclamacoes_raw$tam_titulo = nchar(reclamacoes_raw$titulo)
reclamacoes_raw$tam_reclamacao = nchar(reclamacoes_raw$reclamacao)
```

Removendo stopwords

```{r warning=FALSE, message=FALSE, error=FALSE}
remove_stopwords = function(raw_texto) {
    corpus = Corpus(VectorSource(raw_texto))
    texto = tm_map(corpus, PlainTextDocument)
    texto = tm_map(texto, removeWords, stopwords('pt'))
    texto = tm_map(texto, stripWhitespace)
    #texto = tm_map(texto, removePunctuation)
    #texto = tm_map(texto, removeNumbers)
    #texto = tm_map(texto, content_transformer(tolower))
    return(texto)
}
```

Calculando tamanho de texto sem stopwords

```{r warning=FALSE, message=FALSE, error=FALSE}
reclamacoes_raw$sem_stopwords = remove_stopwords(reclamacoes_raw$reclamacao)
```

Calculando quantidade de palavras

```{r warning=FALSE, message=FALSE, error=FALSE}
split_words = function(texto) {
    return(strsplit(texto, " "))
}

count_words = function(texto) {
    n_words = sapply(gregexpr("[[:alpha:]]+", texto), function(x) sum(x > 0))
    return(n_words)
}

reclamacoes_raw$words = split_words(reclamacoes_raw$reclamacao)
reclamacoes_raw$n_words = count_words(reclamacoes_raw$words)
```

Calculando quantidade de palavras em caixa alta

```{r warning=FALSE, message=FALSE, error=FALSE}

filterUpperWords = function(w) {
    if (grepl("^[[:upper:]]+$", w)) return(TRUE) else return(FALSE)
}

uppercase_words = function(vector_of_words) {
    return(Filter(filterUpperWords, vector_of_words))
}

reclamacoes_raw$upperwords = uppercase_words(reclamacoes_raw$words)
reclamacoes_raw$n_upperwords = lengths(reclamacoes_raw$upperwords)
```

```{r}

```


## Análise dos dados de validação
